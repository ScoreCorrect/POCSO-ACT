<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>Quiz Portal</title>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
Â  Â  <script src="questions.js"></script>
Â  Â  <style>
Â  Â  Â  Â  :root { --primary: #2563eb; --success: #22c55e; --danger: #ef4444; --warning: #f59e0b; --gray: #e2e8f0; --dark: #0f172a; }
Â  Â  Â  Â  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; background: #f8fafc; color: var(--dark); -webkit-tap-highlight-color: transparent; position: relative; min-height: 100vh; overflow-x: hidden; }

Â  Â  Â  Â  /* Header */
Â  Â  Â  Â  .header {Â 
Â  Â  Â  Â  Â  Â  display: flex; justify-content: space-between; align-items: center;
Â  Â  Â  Â  Â  Â  background: white; padding: 12px 16px; border-bottom: 1px solid var(--gray);
Â  Â  Â  Â  Â  Â  position: sticky; top: 0; z-index: 100; height: 60px; box-sizing: border-box;
Â  Â  Â  Â  }
Â  Â  Â  Â  .quiz-title { font-weight: 800; font-size: 1rem; color: var(--primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 60%; }
Â  Â  Â  Â  .timer { font-family: 'Courier New', monospace; font-weight: bold; color: var(--danger); font-size: 1.2rem; }

Â  Â  Â  Â  /* Navigation Drawer */
Â  Â  Â  Â  #nav-drawer {
Â  Â  Â  Â  Â  Â  position: fixed; top: 0; right: -285px; width: 280px; height: 100%;
Â  Â  Â  Â  Â  Â  background: white; box-shadow: -5px 0 15px rgba(0,0,0,0.1);
Â  Â  Â  Â  Â  Â  z-index: 1001; transition: transform 0.3s cubic-bezier(0, 0, 0.2, 1);
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column;
Â  Â  Â  Â  }
Â  Â  Â  Â  #nav-drawer.open { transform: translateX(-285px); }
Â  Â  Â  Â  .drawer-header { padding: 20px; border-bottom: 1px solid var(--gray); }
Â  Â  Â  Â  .drawer-content { flex: 1; overflow-y: auto; padding: 20px; -webkit-overflow-scrolling: touch; }

Â  Â  Â  Â  .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 1000; }

Â  Â  Â  Â  .nav-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 20px; }
Â  Â  Â  Â  .nav-dot {Â 
Â  Â  Â  Â  Â  Â  aspect-ratio: 1/1; border: 1px solid #cbd5e1; border-radius: 6px;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: center; font-size: 0.85rem;
Â  Â  Â  Â  Â  Â  background: white; cursor: pointer; font-weight: 500;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-dot.attempted { background: var(--primary); color: white; border-color: var(--primary); }
Â  Â  Â  Â  .nav-dot.current { border: 2px solid black; background: #f1f5f9; }

Â  Â  Â  Â  /* Quiz UI */
Â  Â  Â  Â  .container { padding: 16px; max-width: 600px; margin: auto; position: relative; z-index: 10; }
Â  Â  Â  Â  .question-card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid var(--gray); }
Â  Â  Â  Â  .option-item { padding: 14px; margin: 10px 0; border: 2px solid var(--gray); border-radius: 10px; display: flex; align-items: center; cursor: pointer; transition: 0.1s; }
Â  Â  Â  Â  .option-item input { width: 20px; height: 20px; margin-right: 12px; flex-shrink: 0; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Controls */
Â  Â  Â  Â  .controls { display: flex; justify-content: space-between; gap: 10px; margin-top: 25px; }
Â  Â  Â  Â  button { border: none; border-radius: 8px; font-weight: 700; font-size: 0.95rem; cursor: pointer; }
Â  Â  Â  Â  .btn-prev { background: #cbd5e1; color: var(--dark); flex: 1; padding: 15px; }
Â  Â  Â  Â  .btn-next { background: var(--primary); color: white; flex: 1; padding: 15px; }
Â  Â  Â  Â  .btn-menu { background: #f1f5f9; color: var(--dark); width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }

Â  Â  Â  Â  /* Screens */
Â  Â  Â  Â  #login-screen, #quiz-screen, #final-screen, #review-screen { display: none; }
Â  Â  Â  Â  .active { display: block !important; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #final-screen { text-align: center; padding-top: 10vh; }
Â  Â  Â  Â  .score-display { font-size: 2.5rem; font-weight: 800; color: var(--primary); margin: 20px 0; }

Â  Â  Â  Â  /* Review Section Styles */
Â  Â  Â  Â  .review-card { background: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border: 1px solid var(--gray); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
Â  Â  Â  Â  .review-option { padding: 10px; border: 1px solid var(--gray); margin: 5px 0; border-radius: 6px; color: #64748b; font-size: 0.9rem; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Review Colors */
Â  Â  Â  Â  .review-correct { border: 2px solid var(--success); background: #dcfce7; color: var(--success); font-weight: bold; }
Â  Â  Â  Â  .review-wrong { border: 2px solid var(--danger); background: #fee2e2; color: var(--danger); font-weight: bold; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .q-header-review { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
Â  Â  Â  Â  .q-text-review { font-weight: bold; display: block; flex: 1; margin-right: 10px; }
Â  Â  Â  Â  .status-badge { font-size: 0.75rem; padding: 4px 8px; border-radius: 4px; font-weight: bold; white-space: nowrap; }

Â  Â  Â  Â  /* ADDED: Watermark Styles */
Â  Â  Â  Â  .watermark-container {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%) rotate(-45deg);
Â  Â  Â  Â  Â  Â  z-index: 0;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .watermark-text {
Â  Â  Â  Â  Â  Â  font-size: 12vw;
Â  Â  Â  Â  Â  Â  font-weight: 900;
Â  Â  Â  Â  Â  Â  color: rgba(0, 0, 0, 0.04); /* Very light gray */
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

Â  Â  <div class="watermark-container">
Â  Â  Â  Â  <div class="watermark-text">ScoreCorrectPSC</div>
Â  Â  </div>

Â  Â  <div class="overlay" id="overlay" onclick="toggleMenu()"></div>

Â  Â  <div id="nav-drawer">
Â  Â  Â  Â  <div class="drawer-header">
Â  Â  Â  Â  Â  Â  <h3 style="margin:0">Question Status</h3>
Â  Â  Â  Â  Â  Â  <small>Tap a number to jump</small>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="drawer-content"><div class="nav-grid" id="nav-grid"></div></div>
Â  Â  Â  Â  <div style="padding: 15px; border-top: 1px solid var(--gray);">
Â  Â  Â  Â  Â  Â  <button onclick="toggleMenu()" style="background: var(--dark); color: white; width: 100%; padding: 12px;">Back to Question</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="login-screen" class="active container">
Â  Â  Â  Â  <div class="question-card" style="margin-top: 50px; text-align: center;">
Â  Â  Â  Â  Â  Â  <h1 style="color:var(--primary); margin-bottom: 8px;">POCSO ACT</h1>
Â  Â  Â  Â  Â  Â  <p style="color: #64748b;">Enter your full name to begin</p>
Â  Â  Â  Â  Â  Â  <input type="text" id="userName" placeholder="Type your name here..." style="width:100%; padding:15px; margin:20px 0; border:2px solid var(--gray); border-radius:8px; font-size: 1rem; box-sizing:border-box;">
Â  Â  Â  Â  Â  Â  <button onclick="startQuiz()" class="btn-next" style="width:100%">Start Quiz Now</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="quiz-screen">
Â  Â  Â  Â  <div class="header">
Â  Â  Â  Â  Â  Â  <span class="quiz-title">POCSO ACT</span>
Â  Â  Â  Â  Â  Â  <div style="display: flex; align-items: center; gap: 8px;">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="timer" id="timer">30:00</span>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-menu" onclick="toggleMenu()">â˜°</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="container">
Â  Â  Â  Â  Â  Â  <div class="question-card">
Â  Â  Â  Â  Â  Â  Â  Â  <span id="q-counter" style="color: var(--primary); font-weight: bold; font-size: 0.8rem;">QUESTION 1</span>
Â  Â  Â  Â  Â  Â  Â  Â  <h3 id="q-text" style="margin-top: 10px; line-height: 1.4;"></h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="options-container"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="prevBtn" class="btn-prev" onclick="changeQuestion(-1)">Previous</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="nextBtn" class="btn-next" onclick="changeQuestion(1)">Next Question</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="submitBtn" class="btn-next" style="background:var(--success); display:none;" onclick="finishQuiz()">Submit Final Result</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="final-screen" class="container">
Â  Â  Â  Â  <div style="font-size: 4rem; margin-bottom: 10px;">ğŸ†</div>
Â  Â  Â  Â  <div id="final-msg-container"></div>
Â  Â  </div>

Â  Â  <div id="review-screen" class="container">
Â  Â  Â  Â  <h2 style="text-align: center; color: var(--primary); margin-top: 10px;">Your Responses</h2>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div style="text-align: center; margin-bottom: 15px; font-size: 0.8rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
Â  Â  Â  Â  Â  Â  <span style="color:var(--success); font-weight:bold;">âœ” Correct</span>
Â  Â  Â  Â  Â  Â  <span style="color:var(--danger); font-weight:bold;">âœ– Wrong</span>
Â  Â  Â  Â  Â  Â  <span style="color:var(--warning); font-weight:bold;">âš  Unattempted</span>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="review-list"></div>
Â  Â  Â  Â  <div style="margin-top: 20px;">
Â  Â  Â  Â  Â  Â  <button class="btn-prev" style="width:100%" onclick="location.reload()">Close / Exit</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  let currentIdx = 0;
Â  Â  Â  Â  let userAnswers = new Array(quizQuestions.length).fill(null);
Â  Â  Â  Â  let timeLeft = 30 * 60;
Â  Â  Â  Â  let timerInterval;

Â  Â  Â  Â  const FORM_ID = "1FAIpQLSdCkXL5LBwnm_n74ClLFsC4k4QVWJXrm7CfzzkhKmWe_KIKyg";Â 
Â  Â  Â  Â  const ENTRY_NAME = "entry.1501316275";
Â  Â  Â  Â  const ENTRY_SCORE = "entry.1274011120";
Â  Â  Â  Â  const ENTRY_TIME = "entry.601190537";

Â  Â  Â  Â  // ADDED: Toggle for multiple entries (true = allow, false = block for 24h)
Â  Â  Â  Â  const ALLOW_MULTIPLE_ENTRIES = false;

Â  Â  Â  Â  // ADDED: Check for previous session on load
Â  Â  Â  Â  window.onload = function() {
Â  Â  Â  Â  Â  Â  const savedData = localStorage.getItem('quiz_progress');
Â  Â  Â  Â  Â  Â  if(savedData) {
Â  Â  Â  Â  Â  Â  Â  Â  const data = JSON.parse(savedData);
Â  Â  Â  Â  Â  Â  Â  Â  if(confirm(`Resume quiz for ${data.name} where you left off?`)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('userName').value = data.name;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  userAnswers = data.answers;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  timeLeft = data.time;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentIdx = data.idx;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Resume immediately
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('login-screen').classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('quiz-screen').classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadQuestion();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startTimer();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem('quiz_progress'); // Clear if they say no
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // ADDED: Function to save progress to local storage
Â  Â  Â  Â  function saveProgress() {
Â  Â  Â  Â  Â  Â  const name = document.getElementById('userName').value;
Â  Â  Â  Â  Â  Â  const data = {
Â  Â  Â  Â  Â  Â  Â  Â  name: name,
Â  Â  Â  Â  Â  Â  Â  Â  answers: userAnswers,
Â  Â  Â  Â  Â  Â  Â  Â  time: timeLeft,
Â  Â  Â  Â  Â  Â  Â  Â  idx: currentIdx
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  localStorage.setItem('quiz_progress', JSON.stringify(data));
Â  Â  Â  Â  }

Â  Â  Â  Â  function toggleMenu() {
Â  Â  Â  Â  Â  Â  const drawer = document.getElementById('nav-drawer');
Â  Â  Â  Â  Â  Â  const overlay = document.getElementById('overlay');
Â  Â  Â  Â  Â  Â  if (drawer.classList.contains('open')) {
Â  Â  Â  Â  Â  Â  Â  Â  drawer.classList.remove('open');
Â  Â  Â  Â  Â  Â  Â  Â  overlay.style.display = 'none';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  renderNav();
Â  Â  Â  Â  Â  Â  Â  Â  drawer.classList.add('open');
Â  Â  Â  Â  Â  Â  Â  Â  overlay.style.display = 'block';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function startQuiz() {
Â  Â  Â  Â  Â  Â  const name = document.getElementById('userName').value.trim();
Â  Â  Â  Â  Â  Â  if(!name) return alert("Please enter your name");

Â  Â  Â  Â  Â  Â  // ADDED: Check for 24-hour block
Â  Â  Â  Â  Â  Â  if (!ALLOW_MULTIPLE_ENTRIES) {
Â  Â  Â  Â  Â  Â  Â  Â  const lastSubmitTime = localStorage.getItem('quiz_last_submitted');
Â  Â  Â  Â  Â  Â  Â  Â  if (lastSubmitTime) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const hoursPassed = (Date.now() - parseInt(lastSubmitTime)) / (1000 * 60 * 60);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (hoursPassed < 24) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return alert("You have already submitted the quiz. Please try again after 24 hours.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Only reset if we are not resuming (checked by existence of timerInterval or logic)
Â  Â  Â  Â  Â  Â  // But here we can just clear any old data if it's a "fresh" start from the button
Â  Â  Â  Â  Â  Â  if(!localStorage.getItem('quiz_progress')) {
Â  Â  Â  Â  Â  Â  Â  Â // Fresh start logic already handled by default variables
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  document.getElementById('login-screen').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('quiz-screen').classList.add('active');
Â  Â  Â  Â  Â  Â  loadQuestion();
Â  Â  Â  Â  Â  Â  startTimer();
Â  Â  Â  Â  Â  Â  saveProgress(); // Initial save
Â  Â  Â  Â  }

Â  Â  Â  Â  function startTimer() {
Â  Â  Â  Â  Â  Â  if(timerInterval) clearInterval(timerInterval); // Prevent duplicates
Â  Â  Â  Â  Â  Â  timerInterval = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  timeLeft--;
Â  Â  Â  Â  Â  Â  Â  Â  let mins = Math.floor(timeLeft / 60);
Â  Â  Â  Â  Â  Â  Â  Â  let secs = timeLeft % 60;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('timer').innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Save progress every 2 seconds roughly, or we can just save here
Â  Â  Â  Â  Â  Â  Â  Â  if(timeLeft % 5 === 0) saveProgress();Â 

Â  Â  Â  Â  Â  Â  Â  Â  if(timeLeft <= 0) finishQuiz();
Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderNav() {
Â  Â  Â  Â  Â  Â  const grid = document.getElementById('nav-grid');
Â  Â  Â  Â  Â  Â  grid.innerHTML = '';
Â  Â  Â  Â  Â  Â  quizQuestions.forEach((_, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  const dot = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  dot.className = `nav-dot ${userAnswers[i] !== null ? 'attempted' : ''} ${i === currentIdx ? 'current' : ''}`;
Â  Â  Â  Â  Â  Â  Â  Â  dot.innerText = i + 1;
Â  Â  Â  Â  Â  Â  Â  Â  dot.onclick = () => { currentIdx = i; loadQuestion(); toggleMenu(); };
Â  Â  Â  Â  Â  Â  Â  Â  grid.appendChild(dot);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function loadQuestion() {
Â  Â  Â  Â  Â  Â  const q = quizQuestions[currentIdx];
Â  Â  Â  Â  Â  Â  document.getElementById('q-counter').innerText = `QUESTION ${currentIdx + 1} OF ${quizQuestions.length}`;
Â  Â  Â  Â  Â  Â  document.getElementById('q-text').innerText = q.question;
Â  Â  Â  Â  Â  Â  const container = document.getElementById('options-container');
Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â  q.options.forEach((opt, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement('label');
Â  Â  Â  Â  Â  Â  Â  Â  div.className = 'option-item';
Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `<input type="radio" name="quizOpt" value="${i}" ${userAnswers[currentIdx] === i ? 'checked' : ''} onchange="saveAnswer(${i})"> <span>${opt}</span>`;
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(div);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById('prevBtn').style.visibility = currentIdx === 0 ? 'hidden' : 'visible';
Â  Â  Â  Â  Â  Â  document.getElementById('nextBtn').style.display = currentIdx === quizQuestions.length - 1 ? 'none' : 'block';
Â  Â  Â  Â  Â  Â  document.getElementById('submitBtn').style.display = currentIdx === quizQuestions.length - 1 ? 'block' : 'none';
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveAnswer(val) {Â 
Â  Â  Â  Â  Â  Â  userAnswers[currentIdx] = val;Â 
Â  Â  Â  Â  Â  Â  saveProgress(); // ADDED: Save on every answer
Â  Â  Â  Â  }

Â  Â  Â  Â  function changeQuestion(step) {
Â  Â  Â  Â  Â  Â  currentIdx += step;
Â  Â  Â  Â  Â  Â  loadQuestion();
Â  Â  Â  Â  Â  Â  window.scrollTo(0,0);
Â  Â  Â  Â  Â  Â  saveProgress(); // ADDED: Save on navigation
Â  Â  Â  Â  }

Â  Â  Â  Â  function finishQuiz() {
Â  Â  Â  Â  Â  Â  if(timeLeft > 0 && !confirm("Finish and submit your answers?")) return;
Â  Â  Â  Â  Â  Â  clearInterval(timerInterval);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // ADDED: Clear saved progress so they can't resume a finished quiz
Â  Â  Â  Â  Â  Â  localStorage.removeItem('quiz_progress');

Â  Â  Â  Â  Â  Â  // ADDED: Save submission time to prevent multiple entries
Â  Â  Â  Â  Â  Â  localStorage.setItem('quiz_last_submitted', Date.now().toString());

Â  Â  Â  Â  Â  Â  // Score Calculation
Â  Â  Â  Â  Â  Â  let score = 0;
Â  Â  Â  Â  Â  Â  userAnswers.forEach((ans, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  if(ans === null) return;
Â  Â  Â  Â  Â  Â  Â  Â  if(ans === quizQuestions[i].correct) { score += 1; }Â 
Â  Â  Â  Â  Â  Â  Â  Â  else { score -= (1/3); }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  const finalScore = score.toFixed(2);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const name = document.getElementById('userName').value;
Â  Â  Â  Â  Â  Â  const timeTaken = Math.floor((30 * 60 - timeLeft) / 60) + " mins";

Â  Â  Â  Â  Â  Â  // Send data
Â  Â  Â  Â  Â  Â  const formUrl = `https://docs.google.com/forms/d/e/${FORM_ID}/formResponse?${ENTRY_NAME}=${encodeURIComponent(name)}&${ENTRY_SCORE}=${finalScore}&${ENTRY_TIME}=${timeTaken}&submit=Submit`;
Â  Â  Â  Â  Â  Â  fetch(formUrl, { mode: 'no-cors' });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('quiz-screen').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('final-screen').classList.add('active');

Â  Â  Â  Â  Â  Â  // ADDED: Trigger Confetti for 1.5 Seconds
Â  Â  Â  Â  Â  Â  launchConfetti();

Â  Â  Â  Â  Â  Â  // ADDED: Show final score in the message
Â  Â  Â  Â  Â  Â  document.getElementById('final-msg-container').innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="margin: 0 0 20px 0; color: var(--dark);">Hi ${name}</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <p style="color: #475569; font-size: 1.1rem; line-height: 1.6; margin-bottom: 30px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Your mark has been submitted.<br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong style="color: var(--primary); font-size: 1.5rem;">Your Score: ${finalScore}</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Ranklist will be soon available.</strong>
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-next" onclick="showReview()">View Your Response</button>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  }

Â  Â  Â  Â  // ADDED: Confetti Function
Â  Â Â 
Â  Â  Â  Â  function launchConfetti() {
Â  Â  Â  Â  Â  Â  var duration = 10 * 1000; // 10 seconds
Â  Â  Â  Â  Â  Â  var animationEnd = Date.now() + duration;
Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  var interval = setInterval(function() {
Â  Â  Â  Â  Â  Â  Â  Â  var timeLeft = animationEnd - Date.now();
Â  Â  Â  Â  Â  Â  Â  Â  if (timeLeft <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return clearInterval(interval);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  // Launch a variety burst from a random spot
Â  Â  Â  Â  Â  Â  Â  Â  confetti({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  particleCount: 50,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  startVelocity: 30,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  spread: 360,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ticks: 60,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Random position on the screen
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  origin: { x: Math.random(), y: Math.random() - 0.2 },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  colors: ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff'],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  shapes: ['circle', 'square'],Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scalar: Math.random() * 1.5 + 0.5Â 
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 250);
Â  Â  Â  Â  }

Â  Â  Â  Â  function showReview() {
Â  Â  Â  Â  Â  Â  document.getElementById('final-screen').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('review-screen').classList.add('active');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const list = document.getElementById('review-list');
Â  Â  Â  Â  Â  Â  list.innerHTML = '';

Â  Â  Â  Â  Â  Â  quizQuestions.forEach((q, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  const userAns = userAnswers[i];
Â  Â  Â  Â  Â  Â  Â  Â  const isCorrect = userAns === q.correct;
Â  Â  Â  Â  Â  Â  Â  Â  const isUnattempted = userAns === null;

Â  Â  Â  Â  Â  Â  Â  Â  // Determine Badge Text & Color
Â  Â  Â  Â  Â  Â  Â  Â  let badgeText = "";
Â  Â  Â  Â  Â  Â  Â  Â  let badgeColor = "";

Â  Â  Â  Â  Â  Â  Â  Â  if(isUnattempted) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  badgeText = "âš  Unattempted";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  badgeColor = "color: var(--warning); background: #fffbeb; border: 1px solid var(--warning);";
Â  Â  Â  Â  Â  Â  Â  Â  } else if(isCorrect) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  badgeText = "âœ” Correct";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  badgeColor = "color: var(--success); background: #dcfce7; border: 1px solid var(--success);";
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  badgeText = "âœ– Wrong";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  badgeColor = "color: var(--danger); background: #fee2e2; border: 1px solid var(--danger);";
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  let cardHtml = `<div class="review-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="q-header-review">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="q-text-review">Q${i+1}: ${q.question}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-badge" style="${badgeColor}">${badgeText}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  q.options.forEach((opt, optIdx) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isSelected = userAns === optIdx;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isActualCorrect = q.correct === optIdx;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let styleClass = 'review-option';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let icon = 'â—‹ ';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (isActualCorrect) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  styleClass += ' review-correct'; // Always show Correct Green
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon = 'âœ” ';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (isSelected) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  styleClass += ' review-wrong'; // Show Wrong Red
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon = 'âœ– ';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cardHtml += `<div class="${styleClass}">${icon} ${opt}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  cardHtml += `</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  list.innerHTML += cardHtml;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  window.scrollTo(0,0);
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
